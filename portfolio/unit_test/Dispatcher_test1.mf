; 18649-Fall-2012
; group #2
; Nipunn Koorapati (nkoorapa)
; Jacob Olson (jholson)
; Nick Mazurek (nmazurek)
; Benet Clark (brclark)
; Dispatcher_test1.mf

#INCLUDE defines.mf

; Initialize
0ms  I 0s N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = true
+0ms I 0s N DOOR_CLOSED_SENSOR_[BACK][RIGHT]_CAN_ID DoorClosed BACK RIGHT = true
+0ms I 0s N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = true
+0ms I 0s N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = true

; Verify that the desired floor and dwell are set appropriately, and that
;   we are in the correct state.
;#state '1 STATE_DOORS_CLOSED'
+210ms A S Dispatcher : STATE == STATE_DOORS_CLOSED
+0ms   A S Dispatcher : TARGET_FLOOR == 1
+0ms   A S Dispatcher : TARGET_HALLWAY == BOTH
+0ms   A S Dispatcher : TARGET_DIRECTION == STOP
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 1
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == BOTH
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0ms   A N DESIRED_DWELL_[BACK]_CAN_ID Integer : getValue == 5000
+0ms   A N DESIRED_DWELL_[FRONT]_CAN_ID Integer : getValue == 5000

;#transition 'DIST1'
+10ms I 0s N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = false
+0ms  I 0s N AT_FLOOR_[1][BACK]_CAN_ID AtFloor 1 BACK = false
+0ms  I 0s N AT_FLOOR_[1][FRONT]_CAN_ID AtFloor 1 FRONT = false

;#state '3 STATE_DOORS_OPEN_BETWEEN_FLOORS'
+210ms A S Dispatcher : STATE == STATE_DOORS_OPEN_BETWEEN_FLOORS
+0ms   A S Dispatcher : TARGET_FLOor == 1
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 1
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == NONE
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0ms   A N DESIRED_DWELL_[BACK]_CAN_ID Integer : getValue == 5000
+0ms   A N DESIRED_DWELL_[FRONT]_CAN_ID Integer : getValue == 5000

;#transition 'DIST6'
+10ms  I 0s N AT_FLOOR_[1][BACK]_CAN_ID AtFloor 1 BACK = true
+0ms  I 0s N AT_FLOOR_[1][FRONT]_CAN_ID AtFloor 1 FRONT = true
+0ms I 0s N HALL_CALL[2][BACK][UP]_CAN_ID Boolean = true

;#state '2 STATE_DOORS_OPEN_AT_FLOOR'
+210ms A S Dispatcher : STATE == STATE_DOORS_OPEN_AT_FLOOR
+0ms   A S Dispatcher : TARGET_FLOOR == 2
+0ms   A S Dispatcher : TARGET_HALLWAY == BACK
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == BACK
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0ms   A N DESIRED_DWELL_[BACK]_CAN_ID Integer : getValue == 5000
+0ms   A N DESIRED_DWELL_[FRONT]_CAN_ID Integer : getValue == 5000

;#transition 'DIST4'
+10ms I 0s N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = true

;#state '1 STATE_DOORS_CLOSED'
+210ms A S Dispatcher : STATE == STATE_DOORS_CLOSED
+0ms   A S Dispatcher : TARGET_FLOOR == 2
+0ms   A S Dispatcher : TARGET_HALLWAY == BACK
+0ms   A S Dispatcher : TARGET_DIRECTION == STOP
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == BACK
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0ms   A N DESIRED_DWELL_[BACK]_CAN_ID Integer : getValue == 5000
+0ms   A N DESIRED_DWELL_[FRONT]_CAN_ID Integer : getValue == 5000

;#transition 'DIST3'
+10ms I 0s N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = false
+0ms  I 0s N AT_FLOOR_[1][BACK]_CAN_ID AtFloor 1 BACK = false
+0ms  I 0s N AT_FLOOR_[1][FRONT]_CAN_ID AtFloor 1 FRONT = false
+0ms  I 0s N AT_FLOOR_[2][BACK]_CAN_ID AtFloor 2 BACK = true

;#state '2 STATE_DOORS_OPEN_AT_FLOOR'
+210ms A S Dispatcher : STATE == STATE_DOORS_OPEN_AT_FLOOR
+0ms   A S Dispatcher : TARGET_FLOOR == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == BACK
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0ms   A N DESIRED_DWELL_[BACK]_CAN_ID Integer : getValue == 5000
+0ms   A N DESIRED_DWELL_[FRONT]_CAN_ID Integer : getValue == 5000

;#transition 'DIST5'
+10ms I 0s N AT_FLOOR_[2][BACK]_CAN_ID AtFloor 2 BACK = false
+0ms  I 0s N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = false

;#state '3 STATE_DOORS_OPEN_BETWEEN_FLOORS'
+210ms A S Dispatcher : STATE == STATE_DOORS_OPEN_BETWEEN_FLOORS
+0ms   A S Dispatcher : TARGET_FLOOR == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == NONE
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0ms   A N DESIRED_DWELL_[BACK]_CAN_ID Integer : getValue == 5000
+0ms   A N DESIRED_DWELL_[FRONT]_CAN_ID Integer : getValue == 5000

; Turn off hall calls
+0ms I 0s N HALL_CALL[2][BACK][UP]_CAN_ID Boolean = false

;#transition 'DIST2'
+10ms I 0s N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = true

;#state '1 STATE_DOORS_CLOSED'
+210ms A S Dispatcher : STATE == STATE_DOORS_CLOSED
+0ms   A S Dispatcher : TARGET_FLOOR == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 2
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == NONE
+0ms   A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0ms   A N DESIRED_DWELL_[BACK]_CAN_ID Integer : getValue == 5000
+0ms   A N DESIRED_DWELL_[FRONT]_CAN_ID Integer : getValue == 5000
